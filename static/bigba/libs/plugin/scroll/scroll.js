!function(){function t(t){try{var i=t.run,e=t.itemArr,r=t.scrollDirection,n=Math.floor(i.bodyWidth/i.itemWidth),s=r?n:-n,l=i.startIndex,a=i.endIndex;l+s>1&&(l+=s,a+=s);for(var d=l-1,h=e.length;h>d&&a>d;d++){var o=e[d];imgD=o.find("img").eq(0),reSrc=imgD.attr("data-src"),reSrc&&(imgD.attr("src",reSrc),imgD.attr("data-src",""))}}catch(c){}}require("bigba:static/utils/Browser.js");Class.define("Scroll",{extend:plugin.Base,v_selector:function(){return this.parent()+",.prev|prev,.next|next"},initialize:function(t){this.parent(t),this.getWrapHtml(),this.prev=this.find(".prev_disable"),this.next=this.find(".next_disable"),this.items=this.find(".items"),this.body=this.find(".body"),this.itemArr=[],this.$root.addClass("jscroll")},getWrapHtml:function(){this.$root.append('<a class="prev_disable"><span></span></a>').append('<div class="body"><ul class="items"></ul></div>').append('<a class="next_disable" ><span></span></a>')},getItemTemplate:function(){return'<li class="item"><a href="{link}" target="_blank" ><img onload="util.stretchImg(this,156,110,true)" onerror="util.errorImg(this)" src="{url}" /></a><div class="title">{cn_name}</div></li>'},createItem:function(t,i){return t._index=i+1,$(util.format(this.getItemTemplate(),t))},init:function(i){var e=this,r=0;$.each(i,function(t,i){var n=e.createItem(i,t);e.items.append(n),e.itemArr.push(n),0==r&&(r=n.outerWidth(!0))}),e.run={itemWidth:r,itemsWidth:e.itemArr.length*r,bodyWidth:e.body.outerWidth(),running:!1},e.run.visibleItems=e.run.bodyWidth/e.run.itemWidth,e.items.css({width:e.run.itemsWidth,left:0}),e.scrolled(),t(e)},scrolled:function(){var t=this.run;t.left=parseInt(this.items[0].style.left.replace("px",""),10),t.right=t.itemsWidth+t.left-t.bodyWidth,t.prev=t.left+t.bodyWidth,t.prev=t.prev>0?0:t.prev,t.next=t.right>t.bodyWidth?t.left-t.bodyWidth:t.bodyWidth-t.itemsWidth,t.startIndex=-t.left/t.itemWidth+1,t.endIndex=t.startIndex+t.visibleItems-1,t.endIndex>this.itemArr.length&&(t.endIndex=this.itemArr.length),this.prev.attr("class",t.left<0?"prev":"prev_disable"),this.next.attr("class",t.right>0?"next":"next_disable")},scroll:function(i){var e=this;this.run.left!=i&&(this.run.running=!0,this.items.stop(!0,!1),t(this),this.items.animate({left:i},500,function(){e.run.running=!1,e.scrolled()}))},prev_click:function(){this.scrollDirection=0,this.run.running||this.scroll(this.run.prev)},next_click:function(){this.scrollDirection=1,this.run.running||this.scroll(this.run.next)}}),$.fn.scroll=function(t){t=t||{},t.$root=$(this),$(this).data("scroll",Scroll.main(t)),$(this).data("scroll").init(t.items)}}();