define("bigba:static/utils/timer.js",function(n,e,t){!function(){var n={tmpl:function(n,e){var t=/\{([^\}]*)\}/g;return n.replace(t,function(n,t){return"undefined"!=typeof e[t]?e[t]:""})}},e=function(n,t){var o=this;if(o.nodeMapList=[],$.isPlainObject(n)?(t=n,t.container=$(document.body)):(t=t||{},t.container=$(n)),o.options=$.extend({},e.DEFAULTS,t),!o.paramsCheck())throw new Error("参数配置有误");return o.init(),o};e.PRECISION={day:"day",hour:"hour",minute:"minute",second:"second"},e.DEFAULTS={selector:"[data-role='timer']",step:1,now:0,end:null,precision:e.PRECISION.second,timingTpl:"{days}天{hours}小时{minutes}分{seconds}秒",endTpl:"已结束"},e.prototype={init:function(){var n,e=this,t=e.options,o=$(t.selector,t.container),i=e.nodeMapList;o.each(function(e,o){n=o.getAttribute("data-end"),n||(n=t.end>0?t.end:t.now),i.push({node:o,life:n-t.now})}),e.loop()},paramsCheck:function(){var n=this,e=n.options,t=function(){};return e.now=e.now,e.end=e.end?e.end:0,e.step=parseInt(e.step),e.on=e.on||{},e.on.end=$.isFunction(e.on.end)?e.on.end:t,e.selector&&e.now&&!isNaN(e.step)?(e.step=Math.max(1e3*e.step,1e3),!0):!1},loop:function(){var n=this;clearTimeout(n.loopTimer),n.burn(),n.filter(),n.refresh(),n.nodeMapList.length>0&&(n.loopTimer=setTimeout(function(){n.loop()},n.options.step))},refresh:function(){var e=this,t=e.options.timingTpl,o=(e.options.endTpl,e.nodeMapList);$.each(o,function(o,i){i.node.innerHTML=n.tmpl(t,e.convertDate(i.life))})},filter:function(){{var n=this,e=[],t=[];n.options,n.nodeMapList}$.each(n.nodeMapList,function(n,o){o.life<=0?t.push(o):e.push(o)}),t.length>0&&n.onEnd(t),n.nodeMapList=e},burn:function(){var n=this,e=n.options,t=n.nodeMapList;$.each(t,function(n,t){t.life-=e.step})},convertDate:function(n){var t=this.options.precision,o=1e3,i=60*o,s=60*i,r=24*s,a=0,p=0,c=0,d=0;switch(t){case e.PRECISION.day:a=parseInt(n/r);break;case e.PRECISION.hour:a=parseInt(n/r),p=parseInt(n%r/s);break;case e.PRECISION.minute:a=parseInt(n/r),p=parseInt(n%r/s),c=parseInt(n%s/i);break;case e.PRECISION.second:a=parseInt(n/r),p=parseInt(n%r/s),c=parseInt(n%s/i),d=parseInt(n%i/o)}return{days:a,hours:p,minutes:c,seconds:d}},restart:function(n,e,t){var o,i=this,s={},r=i.nodeMapList;if(o=$(n,i.container)[0],e&&t)if(s.node=o,s.life=t-e,s.life<=0)i.onEnd([s]);else{for(var a=0;a<r.length;a++)if(r[a].node==o){r.splice(a,1);break}r.push(s),i.loop()}},onEnd:function(n){var e=this,t=e.options.on.end;$.each(n,function(n,t){t.node.innerHTML=e.options.endTpl}),t(n)}},t.exports=e}()});