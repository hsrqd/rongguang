define("bigba:widget/common/ui/shopcard/shopcard.js",function(require,exports,module){function ShopCard(e){this.opt=$.extend(_opt,e),this.bindEvent(),this.renderList(this.opt.data,this.opt.display_new_shop,this.opt.server_time)}var shopCardTmpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push("    ");var __default_src="/static/images/shopcard_loading.png";_template_fun_array.push("    ");for(var i=0,len=data.length;len>i;i++){var shop=data[i];_template_fun_array.push('    <li class="list-item shopcard '),_template_fun_array.push(0==shop.is_online?" offline ":" online "),_template_fun_array.push('" data="',"undefined"==typeof shop.release_id?"":baidu.template._encodeHTML(shop.release_id),'" > '),0==shop.is_online&&(_template_fun_array.push(""),1==shop.bussiness_status?_template_fun_array.push('            <figure class="shop-rest-icon">            </figure>'):4==shop.bussiness_status&&_template_fun_array.push('<figure class="shop-closed-icon">            </figure>        '),_template_fun_array.push("")),_template_fun_array.push("");var is_new=shop.is_new;_template_fun_array.push(""),display_new_shop&&0!=shop.is_online&&(_template_fun_array.push(""),is_new&&_template_fun_array.push('<div class="newshop"><span>新店</span></div>'),_template_fun_array.push("")),_template_fun_array.push('        <div class="shopimg">            ');var url=shop.shop_logo?shop.shop_logo:shop.logo_url;_template_fun_array.push("");var is_collected=shop.is_collected;_template_fun_array.push("            "),url?_template_fun_array.push('                <img width="228" height="140" data-src="http://webmap',"undefined"==typeof parseInt(3*Math.random())?"":baidu.template._encodeHTML(parseInt(3*Math.random())),".map.bdimg.com/maps/services/thumbnails?width=228&height=140&align=center,center&quality=100&src=","undefined"==typeof encodeURI(url)?"":baidu.template._encodeHTML(encodeURI(url)),'" alt="',"undefined"==typeof shop.shop_name?"":baidu.template._encodeHTML(shop.shop_name),'" onerror="this.src=&#39;',"undefined"==typeof __default_src?"":baidu.template._encodeHTML(__default_src),'&#39;" src="',baidu.template._encodeHTML("/static/images/shopcard_loading.png"),'"/>            '):_template_fun_array.push('                <img width="228" height="140" src="',baidu.template._encodeHTML("/static/images/shopcard_default_bg.png"),'"/>            '),_template_fun_array.push(""),is_collected&&_template_fun_array.push('<div class="collected">&nbsp; </div>'),_template_fun_array.push("            "),shop.start_time&&(_template_fun_array.push('                <div class="shopdesc">'),2==shop.bussiness_status?_template_fun_array.push("<span>接受预订&nbsp;</span>","undefined"==typeof shop.start_time?"":baidu.template._encodeHTML(shop.start_time),"开始配送"):3==shop.bussiness_status&&_template_fun_array.push("","undefined"==typeof shop.start_time?"":baidu.template._encodeHTML(shop.start_time),"开始营业"),_template_fun_array.push("</div>            ")),_template_fun_array.push('        </div>        <div class="title" title="',"undefined"==typeof shop.shop_name?"":baidu.template._encodeHTML(shop.shop_name),'">            '),shop.shop_name&&_template_fun_array.push("","undefined"==typeof(shop.shop_name.length<=11?shop.shop_name:shop.shop_name.slice(0,11)+"...")?"":baidu.template._encodeHTML(shop.shop_name.length<=11?shop.shop_name:shop.shop_name.slice(0,11)+"..."),""),_template_fun_array.push(""),shop.is_certificated&&_template_fun_array.push('<span class="cert-icon"><img src="http://waimai.baidu.com/static/forpc/certificated_s.png"/></span>'),_template_fun_array.push("        </div>        ");var score=shop.comment_num?shop.comment_num>=10?shop.average_score:0:shop.average_score;_template_fun_array.push('        <div class="info s-info clearfix">            <div class="f-col f-star star-control" data-star="',"undefined"==typeof score?"":baidu.template._encodeHTML(score),'">                <span class="rate">                    <span class="rate-inner" style="width:',"undefined"==typeof(14.4*score)?"":baidu.template._encodeHTML(14.4*score),'px"></span>                </span>            </div>            <div class="f-col f-sale">                已售<span>',"undefined"==typeof shop.saled?"":baidu.template._encodeHTML(shop.saled),'</span>份            </div>        </div>        <div class="info f-info clearfix">            <div class="f-col f-price">                <span class="item-label">起送:</span>                <span class="item-value">&#165;',"undefined"==typeof shop.takeout_price?"":baidu.template._encodeHTML(shop.takeout_price),'</span>            </div>            <div class="f-col f-cost">                <span class="item-label">配送:</span>                <span class="item-value">                    &#165;',"undefined"==typeof shop.takeout_cost?"":baidu.template._encodeHTML(shop.takeout_cost),"                    ");for(var j=0,welfareLen=shop.welfare_info.length;welfareLen>j;j++){var welfareItem=shop.welfare_info[j];_template_fun_array.push("                        "),"mian"==welfareItem.type&&_template_fun_array.push('                        <i class="item-line"></i>                        '),_template_fun_array.push("                    ")}_template_fun_array.push('                </span>            </div>            <div class="f-col f-time">                '),shop.delivery_time&&""!=shop.delivery_time&&"0"!=shop.delivery_time?(_template_fun_array.push(""),shop.delivery_time>=1440?_template_fun_array.push("","undefined"==typeof Math.floor(shop.delivery_time/1440)?"":baidu.template._encodeHTML(Math.floor(shop.delivery_time/1440)),"天"):shop.delivery_time>=60?(_template_fun_array.push(""),shop.delivery_time%60==0?_template_fun_array.push("","undefined"==typeof(shop.delivery_time/60)?"":baidu.template._encodeHTML(shop.delivery_time/60),"小时"):_template_fun_array.push("","undefined"==typeof Math.floor(shop.delivery_time/60)?"":baidu.template._encodeHTML(Math.floor(shop.delivery_time/60)),"小时","undefined"==typeof(shop.delivery_time%60)?"":baidu.template._encodeHTML(shop.delivery_time%60),"分钟"),_template_fun_array.push("")):_template_fun_array.push("","undefined"==typeof shop.delivery_time?"":baidu.template._encodeHTML(shop.delivery_time),"分钟"),_template_fun_array.push("                                    ")):_template_fun_array.push("                    暂无                "),_template_fun_array.push('            </div>        </div>        <div class="feature">            ');for(var j=0,welfareLen=shop.welfare_info.length;welfareLen>j;j++){var welfareItem=shop.welfare_info[j];_template_fun_array.push('                <em class="',"undefined"==typeof welfareItem.type?"":baidu.template._encodeHTML(welfareItem.type),'-min-icon premium-icon" data-msg="',"undefined"==typeof welfareItem.msg?"":baidu.template._encodeHTML(welfareItem.msg),'"><img src="http://waimai.baidu.com/static/forpc/',"undefined"==typeof welfareItem.type?"":baidu.template._encodeHTML(welfareItem.type),'_s.png" /></em>            ')}if(_template_fun_array.push('        </div>        <div class="overlay">            <div class="o-con">                <div class="shop-title">                    <p>',"undefined"==typeof shop.shop_name?"":baidu.template._encodeHTML(shop.shop_name),""),shop.is_certificated&&_template_fun_array.push('<span class="cert-icon"><img src="http://waimai.baidu.com/static/forpc/certificated_s.png"/></span>'),_template_fun_array.push("</p>                    "),shop.is_certificated&&_template_fun_array.push('<p class="cert-pah">支持查看政府认可的资质证照</p>'),_template_fun_array.push("                </div>                "),shop.welfare_info.length){_template_fun_array.push('                <div class="shop-feature">                    <ul>                        ');for(var j=0,welfareLen=shop.welfare_info.length;welfareLen>j;j++){var welfareItem=shop.welfare_info[j];_template_fun_array.push('                            <li>                                <em class="',"undefined"==typeof welfareItem.type?"":baidu.template._encodeHTML(welfareItem.type),'-min-icon premium-icon"><img src="http://waimai.baidu.com/static/forpc/',"undefined"==typeof welfareItem.type?"":baidu.template._encodeHTML(welfareItem.type),'_s.png"  /></em>                                <p '),"pay"==welfareItem.type&&_template_fun_array.push(' style="width:150px;"'),_template_fun_array.push(">","undefined"==typeof welfareItem.msg?"":baidu.template._encodeHTML(welfareItem.msg),"</p>                            </li>                        ")}_template_fun_array.push("                    </ul>                </div>                ")}_template_fun_array.push('                <div class="shop-notice">                    <h2>商家公告</h2>                    <p>                        '),shop.shop_announcement?_template_fun_array.push("                            ","undefined"==typeof shop.shop_announcement?"":shop.shop_announcement,"                        "):_template_fun_array.push("                            本店欢迎您下单，用餐高峰请提前下单，谢谢！                        "),_template_fun_array.push('                    </p>                </div>            </div>            <div class="o-arrow"></div>        </div>    </li>    ')}_template_fun_array.push(""),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],_opt={data:[],$el:null,listComplete:null};$.extend(ShopCard.prototype,{renderList:function(e,a,t){var s=this.opt.$el;if(e&&e.length>0){var p=shopCardTmpl({data:e,display_new_shop:a,server_time:t});"ul"==s.get(0).tagName.toLowerCase()?(s.addClass("shopcards-list"),s.append(p)):s.find("ul.shopcards-list").length?s.find("ul.shopcards-list").append(p):(s.append("<ul class='shopcards-list'></ul>"),s.find("ul.shopcards-list").append(p)),$(this).trigger("list.complete")}},bindEvent:function(){var e=this.opt.$el;e.on("click","li.list-item",function(){addNStat({da_src:"ShopListBk.ShopItemBtn",da_act:"click",da_trd:"waimai"});var e=$(this).attr("data");stat.trackEvent("shoplist","click",e),window.open("/waimai/shop/"+e)}),$(this).on("list.complete",function(){this.opt.listComplete&&this.opt.listComplete(this.opt)})}}),module.exports=ShopCard});